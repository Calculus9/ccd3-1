!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).ccd3=t.ccd3||{})}(this,(function(t){"use strict";function i(t,i){this._data=t||this._data,this._option=i||this._option,this.render()}class e{constructor(t){this._Class=t}init(t,e){const s=new(0,this._Class)(t,e);return[s,(t,e)=>i.call(s,t,e)]}}const s=new class{constructor(){this._strategies=new Map}registerStrategy(t,i){try{if(this._strategies.has(t))throw new Error(`The [${chartkey}] has been registered.Please change the name and re register.`);return this._strategies.set(t,new e(i)),this}catch(t){console.error(t)}}useStrategy(t,i){try{const{name:e}=i;if("string"!=typeof e)throw new Error("The [name] attribute must be included in option.[name] is used to indicate a chart.");if(!this._strategies.has(e))throw new Error(`The [${e}] chart doesn't exist in the chart factory.`);return this._strategies.get(e).init(t,i)}catch(t){console.error(t)}}};function o(){const{name:t,layout:{margin:i,zoom:e}}=this._option;this._name=t,this._margin={top:i.top,right:i.right,bottom:i.bottom,left:i.left},this._zoom=e}function a(){const{layout:{backgroundColor:t="#fff",color:i="#212121"}}=this._theme;this._container=d3.select(`#${this._domId}`).append("div").attr("id",`${this._domId}Container`).style("background-color",t).style("color",i).style("position","relative").style("width","100%").style("height","100%")}function n(){this._width=this._container.node().clientWidth,this._height=this._container.node().clientHeight,this._innerHeight=this._height-this._margin.top-this._margin.bottom,this._innerWidth=this._width-this._margin.left-this._margin.right,this._viewBox=`0 0 ${this._width} ${this._height}`}function r(){this._svg=this._container.append("svg").attr("id",`${this._domId}Svg`).attr("viewBox",this._viewBox)}function h(){this._svg.call(d3.zoom().on("zoom",(t=>{this._zoomGroup.attr("transform",`translate(${t.transform.x},${t.transform.y}) scale(${t.transform.k})`)})))}function l(){const{layout:{zoom:t}}=this._option;return t?(this._zoomGroup=this._svg.append("g").attr("id",`${this._domId}ZoomGroup`).attr("class","zoom-group"),h.call(this),this._zoomGroup.append("g")):this._svg.append("g")}function c(){this._mainGroup=l.call(this),this._mainGroup.attr("id",`${this._domId}MainGroup`).attr("transform",`translate(${this._margin.left},${this._margin.top})`)}function d(){o.call(this),a.call(this),n.call(this),r.call(this),c.call(this)}function _(){this._axisBottomScale=d3.scaleBand();const{axisBottom:{key:t,scale:{reverse:i=!1,paddingInner:e=.5,paddingOuter:s=.5}}}=this._option;this._axisBottomScale.domain(this._data.map((i=>i[t]))).range(i?[this._innerWidth,0]:[0,this._innerWidth]).paddingInner(e).paddingOuter(s),this._bottomScale=t=>+this._axisBottomScale(t),this._bandwidth=()=>this._axisBottomScale.bandwidth()}function m(){this._axisBottomScale=d3.scaleLinear();const{axisBottom:{key:t,scale:{extent:i=!1,reverse:e=!1,nice:s=!0}}}=this._option;this._axisBottomScale.domain(i?d3.extent(this._data,(i=>i[t])):[0,d3.max(this._data,(i=>i[t]))]).range(e?[this._innerWidth,0]:[0,this._innerWidth]),s&&this._axisBottomScale.nice(),this._bottomScale=t=>+this._axisBottomScale(t)}function f(){if(!this._option.axisBottom||!this._option.axisBottom.scale||!this._option.axisBottom.scale.name)throw new TypeError("[axisBottom] Error!");p.call(this),u.call(this)}function p(){const{axisBottom:{scale:{name:t}}}=this._option;switch(t){case"scaleBand":_.call(this);break;case"scaleLinear":m.call(this);break;default:throw new Error("Unrecognized scale name")}}function u(){(()=>{this._axisBottomGroup||(this._zoomGroup?this._axisBottomGroup=this._zoomGroup.insert("g",`#${this._domId}MainGroup`):this._axisBottomGroup=this._svg.insert("g",`#${this._domId}MainGroup`),this._axisBottomGroup.attr("id",`${this._domId}AxisBottomGroup`).attr("class","axis-bottom-group").attr("transform",`translate(${this._margin.left},${this._innerHeight+this._margin.top})`))})(),(()=>{const{axisBottom:{transition:{duration:t,ease:i}}}=this._option;this._axisBottomGroup.transition().duration(t).ease(i).call(d3.axisBottom(this._axisBottomScale))})()}function g(){this._axisLeftScale=d3.scaleBand();const{axisLeft:{key:t,scale:{reverse:i=!1,paddingInner:e=.5,paddingOuter:s=.5}}}=this._option;this._axisLeftScale.domain(this._data.map((i=>i[t]))).range(i?[0,this._innerHeight]:[this._innerHeight,0]).paddingInner(e).paddingOuter(s),this._bottomScale=t=>+this._axisLeftScale(t),this._bandwidth=()=>this.bandwidth()}function x(){this._axisLeftScale=d3.scaleLinear();const{axisLeft:{key:t,scale:{extent:i=!1,reverse:e=!1,nice:s=!0}}}=this._option;this._axisLeftScale.domain(i?d3.extent(this._data,(i=>i[t])):[0,d3.max(this._data,(i=>i[t]))]).range(e?[0,this._innerHeight]:[this._innerHeight,0]),s&&this._axisLeftScale.nice(),this._leftScale=t=>+this._axisLeftScale(t)}function y(){if(!this._option.axisLeft||!this._option.axisLeft.scale||!this._option.axisLeft.scale.name)throw new TypeError("[axisLeft] Error!");b.call(this),S.call(this)}function b(){const{axisLeft:{scale:{name:t}}}=this._option;switch(t){case"scaleBand":g.call(this);break;case"scaleLinear":x.call(this);break;default:throw new Error("Unrecognized scale name")}}function S(){(()=>{this._axisLeftGroup||(this._zoomGroup?this._axisLeftGroup=this._zoomGroup.insert("g",`#${this._domId}MainGroup`):this._axisLeftGroup=this._svg.insert("g",`#${this._domId}MainGroup`),this._axisLeftGroup.attr("id",`${this._domId}axisLeftGroup`).attr("class","axis-bottom-group").attr("transform",`translate(${this._margin.left},${this._margin.top})`))})(),(()=>{const{axisLeft:{transition:{duration:t,ease:i}}}=this._option;this._axisLeftGroup.transition().duration(t).ease(i).call(d3.axisLeft(this._axisLeftScale))})()}function B(){const{title:{text:t}}=this._option,{title:{textStyle:{x:i="0",y:e="0",color:s="#516b91",fontSize:o="1.5em",fontWeight:a="700"}}}=this._theme;this._titleGroup.selectAll(".title").data([t]).join("text").html((t=>t)).attr("dy","1em").attr("x",i).attr("y",e).style("fill",s).style("font-size",o).style("font-weight",a)}function w(){const{title:{subText:t}}=this._option,{title:{subTextStyle:{x:i="0",y:e="0",color:s="#516b91",fontSize:o="1.5em",fontWeight:a="700"}}}=this._theme;this._titleGroup.selectAll(".sub-title").data([t]).join("text").html((t=>t)).attr("dy","3em").attr("x",i).attr("y",e).style("fill",s).style("font-size",o).style("font-weight",a)}function G(){}function L(t,i,e,s){if(void 0!==this[t])return null;switch(e){case"main":this[t]=v.call(this,i,s);break;case"zoom":this[t]=$.call(this,i,s);break;case"svg":this[t]=k.call(this,i,s);break;default:this[t]=v.call(this,i,s)}return null}function v(t,i){return this._mainGroup.append("g").classed(t,!0).attr("transform",i)}function $(t,i){return this._zoomGroup.append("g").classed(t,!0).attr("transform",i)}function k(t,i){return this._svg.append("g").classed(t,!0).attr("transform",i)}function z(){if(this._titleGroup)return null;L.call(this,"_titleGroup","title-group","svg","translate(0,0)"),B.call(this),w.call(this),G.call(this)}function C(){this._theme,this._tooltip||(this._tooltip=this._container.append("div").classed("ccd3-tooltip",!0))}function I(t,i){this[t].style("cursor","pointer").on("mouseover",(t=>{this._tooltip.transition().style("display","block"),d3.select(t.target).attr("opacity","0.75")})).on("mousemove",((t,e)=>{let s=`${t.offsetX}px`,o=`${t.offsetY}px`;this._tooltip.html(i(t,e)).transition().ease(d3.easeCubic).style("left",s).style("top",o)})).on("mouseout",(t=>{this._tooltip.transition().style("display","none"),d3.select(t.target).attr("opacity","1")}))}function E(t,i){C.call(this),I.call(this,t,i)}const T={name:"default",primary1:"#93b7e3",primary2:"#59c4e6",primary3:"#edafda",primary4:"#516b91",primary5:"#a5e7f0",primary6:"#cbb0e3",colorSets:["#93b7e3"," #59c4e6","#edafda"," #516b91","#a5e7f0"," #cbb0e3"," #3fb1e3"," #6be6c1"," #626c91","#a0a7e6","#c4ebad","#96dee8"],algorithmBar:{},layout:{backgroundColor:"#fff",textColor:"#212121",labelColor:"#eee"},title:{textStyle:{x:"0",y:"0",color:"#516b91",fontSize:"1.5em",fontWeight:"700"},subTextStyle:{color:"#93b7e3",fontSize:"1em",fontWeight:"400"}},axisBottom:{lineColor:"#ccc",textColor:"#999"},axisLeft:{lineColor:"#ccc",textColor:"#999"},tooltip:{textColor:"#212121",backgroundColor:"#ffffffcc",boxShadow:"0 3px 14px rgba(0,0,0,0.4)",border:" 1px solid #eee"}};class W{constructor(t,i,e){this._domId=t,this._option=i,this._theme=e||T,d.call(this,t,i)}render(){f.call(this),y.call(this),z.call(this),L.call(this,"_rectGroup","rect-group","main"),this.renderColorScale(),this.renderRect()}renderColorScale(){const{algorithmBar:{state:t}}=this._option;this._colorScale=d3.scaleOrdinal().domain(Object.keys(t)).range(Object.values(t))}renderRect(){const{algorithmBar:{uniqueKey:t,stateKey:i,animation:{duration:e,ease:s},on:{click:o}},axisBottom:{key:a},axisLeft:{key:n},tooltip:{format:r}}=this._option;this._rectElements=this._rectGroup.selectAll("rect").data(this._data,t?i=>i[t]:t).join((t=>t.append("rect").attr("width",this._bandwidth()).attr("y",this._innerHeight).attr("x",(t=>this._bottomScale(t[a])))),(t=>t),(t=>t.remove())).transition().duration(e).ease(s).attr("height",(t=>this._innerHeight-this._leftScale(t[n]))).attr("y",(t=>this._leftScale(t[n]))).attr("x",(t=>this._bottomScale(t[a]))).attr("fill",(t=>this._colorScale(t[i]))).selection().on("click",((t,i)=>o(t,i,this._data))),E.call(this,"_rectElements",r)}}s.registerStrategy("algorithmBar",W),t.AlgorithmBar=W,t.init=(t,i)=>s.useStrategy(t,i),t.register=(t,i)=>{s.registerStrategy(t,i)},Object.defineProperty(t,"__esModule",{value:!0})}));
