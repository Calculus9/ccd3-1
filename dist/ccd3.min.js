!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ccd3=t.ccd3||{})}(this,(function(t){"use strict";function e(t,e,i){this._data=t||this._data,this._option=e||this._option,this._theme=i||this._theme,this.render()}class i{constructor(t){this._Class=t}init(t,i,s){const o=new(0,this._Class)(t,i);return[o,(t,i)=>e.call(o,t,i,s)]}}const s=new class{constructor(){this._strategies=new Map}registerStrategy(t,e){try{if(this._strategies.has(t))throw new Error(`The [${chartkey}] has been registered.Please change the name and re register.`);return this._strategies.set(t,new i(e)),this}catch(t){console.error(t)}}useStrategy(t,e,i){try{const{name:s}=e;if("string"!=typeof s)throw new Error("The [name] attribute must be included in option.[name] is used to indicate a chart.");if(!this._strategies.has(s))throw new Error(`The [${s}] chart doesn't exist in the chart factory.`);return this._strategies.get(s).init(t,e,i)}catch(t){console.error(t)}}};function o(){this._axisBottomScale=d3.scaleBand();const{axisBottom:{key:t,scale:{reverse:e=!1,paddingInner:i=.5,paddingOuter:s=.5}}}=this._option;this._axisBottomScale.domain(this._data.map((e=>e[t]))).range(e?[this._innerWidth,0]:[0,this._innerWidth]).paddingInner(i).paddingOuter(s),this._bottomScale=t=>+this._axisBottomScale(t),this._bandwidth=()=>this._axisBottomScale.bandwidth()}function a(){this._axisBottomScale=d3.scaleLinear();const{axisBottom:{key:t,scale:{extent:e=!1,reverse:i=!1,nice:s=!0}}}=this._option;this._axisBottomScale.domain(e?d3.extent(this._data,(e=>e[t])):[0,d3.max(this._data,(e=>e[t]))]).range(i?[this._innerWidth,0]:[0,this._innerWidth]),s&&this._axisBottomScale.nice(),this._bottomScale=t=>+this._axisBottomScale(t)}function r(){if(!this._option.axisBottom||!this._option.axisBottom.scale||!this._option.axisBottom.scale.name)throw new TypeError("[axisBottom] Error!");n.call(this),l.call(this)}function n(){const{axisBottom:{scale:{name:t}}}=this._option;switch(t){case"scaleBand":o.call(this);break;case"scaleLinear":a.call(this);break;default:throw new Error("Unrecognized scale name")}}function l(){(()=>{this._axisBottomGroup||(this._zoomGroup?this._axisBottomGroup=this._zoomGroup.insert("g",`#${this._domId}MainGroup`):this._axisBottomGroup=this._svg.insert("g",`#${this._domId}MainGroup`),this._axisBottomGroup.attr("id",`${this._domId}AxisBottomGroup`).attr("transform",`translate(${this._margin.left},${this._innerHeight+this._margin.top})`))})(),(()=>{const{axisBottom:{grid:t=!1,transition:{duration:e,ease:i}}}=this._option,{axisBottom:{tickColor:s="#ccc",textColor:o="#999",lineColor:a="#ccc"}}=this._theme;this._axisBottomGroup.transition().duration(e).ease(i).call((e=>{const i=d3.axisBottom(this._axisBottomScale);return t&&i.tickSizeInner(-this._innerHeight).tickSizeOuter(-this._innerHeight),i(e)})).call((t=>{t.selectAll("text").attr("fill",o),t.selectAll("line").attr("stroke",s),t.selectAll("path").attr("stroke",a)}))})()}function h(){this._axisLeftScale=d3.scaleBand();const{axisLeft:{key:t,scale:{reverse:e=!1,paddingInner:i=.5,paddingOuter:s=.5}}}=this._option;this._axisLeftScale.domain(this._data.map((e=>e[t]))).range(e?[0,this._innerHeight]:[this._innerHeight,0]).paddingInner(i).paddingOuter(s),this._leftScale=t=>+this._axisLeftScale(t),this._bandwidth=()=>this._axisLeftScale.bandwidth()}function c(){this._axisLeftScale=d3.scaleLinear();const{axisLeft:{key:t,scale:{extent:e=!1,reverse:i=!1,nice:s=!0}}}=this._option;this._axisLeftScale.domain(e?d3.extent(this._data,(e=>e[t])):[0,d3.max(this._data,(e=>e[t]))]).range(i?[0,this._innerHeight]:[this._innerHeight,0]),s&&this._axisLeftScale.nice(),this._leftScale=t=>+this._axisLeftScale(t)}function d(){if(!this._option.axisLeft||!this._option.axisLeft.scale||!this._option.axisLeft.scale.name)throw new TypeError("[axisLeft] Error!");_.call(this),m.call(this)}function _(){const{axisLeft:{scale:{name:t}}}=this._option;switch(t){case"scaleBand":h.call(this);break;case"scaleLinear":c.call(this);break;default:throw new Error("Unrecognized scale name")}}function m(){(()=>{this._axisLeftGroup||(this._zoomGroup?this._axisLeftGroup=this._zoomGroup.insert("g",`#${this._domId}MainGroup`):this._axisLeftGroup=this._svg.insert("g",`#${this._domId}MainGroup`),this._axisLeftGroup.attr("id",`${this._domId}axisLeftGroup`).attr("class","axis-bottom-group").attr("transform",`translate(${this._margin.left},${this._margin.top})`))})(),(()=>{const{axisLeft:{grid:t=!1,transition:{duration:e,ease:i}}}=this._option,{axisBottom:{tickColor:s="#ccc",textColor:o="#999",lineColor:a="#ccc"}}=this._theme;this._axisLeftGroup.transition().duration(e).ease(i).call((e=>{const i=d3.axisLeft(this._axisLeftScale);return t&&i.tickSizeInner(-this._innerWidth).tickSizeOuter(-this._innerWidth),i(e)})).call((t=>{t.selectAll("text").attr("fill",o),t.selectAll("line").attr("stroke",s),t.selectAll(".tick:last-child line").attr("stroke",a),t.selectAll(".tick:first-child line").attr("stroke",a),t.selectAll("path").attr("stroke",a)}))})()}function p(t,e,i,s){if(void 0!==this[t])return null;switch(i){case"main":this[t]=f.call(this,e,s);break;case"zoom":this[t]=u.call(this,e,s);break;case"svg":this[t]=g.call(this,e,s);break;default:this[t]=f.call(this,e,s)}return null}function f(t,e){return this._mainGroup.append("g").classed(t,!0).attr("transform",e)}function u(t,e){return this._zoomGroup.append("g").classed(t,!0).attr("transform",e)}function g(t,e){return this._svg.append("g").classed(t,!0).attr("transform",e)}function x(){const{name:t,layout:{margin:e,zoom:i}}=this._option;this._name=t,this._margin={top:e.top,right:e.right,bottom:e.bottom,left:e.left},this._zoom=i}function y(){const{layout:{backgroundColor:t="#fff",color:e="#212121"}}=this._theme;this._container=d3.select(`#${this._domId}`).append("div").attr("id",`${this._domId}Container`).style("background-color",t).style("color",e).style("position","relative").style("width","100%").style("height","100%")}function b(){this._width=this._container.node().clientWidth,this._height=this._container.node().clientHeight,this._innerHeight=this._height-this._margin.top-this._margin.bottom,this._innerWidth=this._width-this._margin.left-this._margin.right,this._viewBox=`0 0 ${this._width} ${this._height}`}function S(){this._svg=this._container.append("svg").attr("id",`${this._domId}Svg`).attr("viewBox",this._viewBox)}function w(){this._svg.call(d3.zoom().on("zoom",(t=>{this._zoomGroup.attr("transform",`translate(${t.transform.x},${t.transform.y}) scale(${t.transform.k})`)})))}function k(){const{layout:{zoom:t=!1}}=this._option;return t?(this._zoomGroup=this._svg.append("g").attr("id",`${this._domId}ZoomGroup`).attr("class","zoom-group"),w.call(this),this._zoomGroup.append("g")):this._svg.append("g")}function B(){this._mainGroup=k.call(this),this._mainGroup.attr("id",`${this._domId}MainGroup`).attr("transform",`translate(${this._margin.left},${this._margin.top})`)}function G(){x.call(this),y.call(this),b.call(this),S.call(this),B.call(this)}function v(){const{title:{text:t}}=this._option,{title:{textStyle:{x:e="0",y:i="0",color:s="#516b91",fontSize:o="1.5em",fontWeight:a="700"}}}=this._theme;this._titleGroup.selectAll(".title").data([t]).join((t=>t.append("text").attr("class","title").attr("dy","1em").attr("x",e).attr("y",i).style("fill",s).style("font-size",o).style("font-weight",a)),(t=>t.transition().attr("class","title").attr("dy","1em").attr("x",e).attr("y",i).style("fill",s).style("font-size",o).style("font-weight",a).selection()),(t=>t.remove())).html((t=>t))}function z(){const{title:{subText:t}}=this._option,{title:{subTextStyle:{x:e="0",y:i="0",color:s="#516b91",fontSize:o="1.5em",fontWeight:a="700"}}}=this._theme;this._titleGroup.selectAll(".sub-title").data([t]).join((t=>t.append("text").attr("class","sub-title").attr("dy","3em").attr("x",e).attr("y",i).style("fill",s).style("font-size",o).style("font-weight",a)),(t=>t.transition().attr("class","sub-title").attr("dy","3em").attr("x",e).attr("y",i).style("fill",s).style("font-size",o).style("font-weight",a).selection()),(t=>t.remove())).html((t=>t))}function L(){}function $(){this._titleGroup||p.call(this,"_titleGroup","title-group","svg","translate(0,0)"),v.call(this),z.call(this),L.call(this)}function C(){const{tooltip:{pointerEvents:t="none",textColor:e="#212121",backgroundColor:i="#ffffffcc",boxShadow:s="0 3px 14px rgba(0,0,0,0.4)",border:o=" 1px solid #eee",borderRadius:a="5px",padding:r="0.75rem 1rem",whiteSpace:n="no-warp",zIndex:l="3080",position:h="absolute"}}=this._theme;this._tooltip||(this._tooltip=this._container.append("div").style("pointer-events",t).style("white-space",n).style("border-radius",a).style("color",e).style("background-color",i).style("border",o).style("box-shadow",s).style("padding",r).style("z-index",l).style("position",h).style("top",0).style("display","none"))}function I(t,e){const{tooltip:{transition:{duration:i,ease:s}}}=this._option;this[t].style("cursor","pointer").on("mouseover",(t=>{this._tooltip.transition().style("display","block"),d3.select(t.target).attr("opacity","0.75")})).on("mousemove",((t,o)=>{let a=`${t.offsetX}px`,r=`${t.offsetY}px`;this._tooltip.html(e(t,o)).transition().duration(i).ease(s).style("left",a).style("top",r)})).on("mouseout",(t=>{this._tooltip.transition().style("display","none"),d3.select(t.target).attr("opacity","1")}))}function E(t,e){C.call(this),I.call(this,t,e)}const A={name:"lightBlue",primary1:"#93b7e3",primary2:"#59c4e6",primary3:"#edafda",primary4:"#516b91",primary5:"#a5e7f0",primary6:"#cbb0e3",colorSets:["#93b7e3"," #59c4e6","#edafda"," #516b91","#a5e7f0"," #cbb0e3"," #3fb1e3"," #6be6c1"," #626c91","#a0a7e6","#c4ebad","#96dee8"],layout:{backgroundColor:"#fff",textColor:"#212121",labelColor:"#eee"},title:{textStyle:{x:"0",y:"0",color:"#516b91",fontSize:"1.5em",fontWeight:"700"},subTextStyle:{x:"0",y:"0",color:"#93b7e3",fontSize:"1em",fontWeight:"400"}},axisBottom:{tickColor:"#eee",lineColor:"#ccc",textColor:"#999"},axisLeft:{lineColor:"#ccc",textColor:"#999"},tooltip:{pointerEvents:"none",textColor:"#212121",backgroundColor:"#ffffffcc",boxShadow:"0 3px 14px rgba(0,0,0,0.4)",border:" 1px solid #eee",borderRadius:"5px",padding:"0.75rem 1rem",whiteSpace:"no-warp",zIndex:"3080",position:"absolute"}};class H{constructor(t,e,i){this._domId=t,this._option=e,this._theme=i||A,G.call(this,t,e)}render(){r.call(this),d.call(this),$.call(this),p.call(this,"_rectGroup","rect-group","main"),this.renderColorScale(),this.renderRect()}renderColorScale(){const{algorithmBar:{state:t}}=this._option;this._colorScale=d3.scaleOrdinal().domain(Object.keys(t)).range(Object.values(t))}renderRect(){const{algorithmBar:{uniqueKey:t,stateKey:e,animation:{duration:i,ease:s},on:{click:o}},axisBottom:{key:a},axisLeft:{key:r},tooltip:{format:n}}=this._option;this._rectElements=this._rectGroup.selectAll("rect").data(this._data,t?e=>e[t]:t).join((t=>t.append("rect").attr("width",this._bandwidth()).attr("y",this._innerHeight).attr("x",(t=>this._bottomScale(t[a])))),(t=>t),(t=>t.remove())).transition().duration(i).ease(s).attr("height",(t=>this._innerHeight-this._leftScale(t[r]))).attr("y",(t=>this._leftScale(t[r]))).attr("x",(t=>this._bottomScale(t[a]))).attr("fill",(t=>this._colorScale(t[e]))).selection().on("click",((t,e)=>o(t,e,this._data))),E.call(this,"_rectElements",n)}}s.registerStrategy("algorithmBar",H);class W{constructor(t,e,i){this._domId=t,this._option=e,this._theme=i||A,G.call(this,t,e)}render(){r.call(this),d.call(this),$.call(this),p.call(this,"_rectGroup","rect-group","main"),this.renderRect()}renderRect(){const{horizontalBar:{uniqueKey:t,animation:{duration:e,ease:i},on:{click:s}},axisBottom:{key:o},axisLeft:{key:a},tooltip:{format:r}}=this._option;console.log(o);const{primary1:n}=this._theme;this._rectElements=this._rectGroup.selectAll("rect").data(this._data,t?e=>e[t]:t).join((t=>t.append("rect").attr("height",this._bandwidth()).attr("width",0).attr("y",(t=>this._leftScale(t[a])))),(t=>t),(t=>t.remove())).transition().duration(e).ease(i).attr("height",this._bandwidth()).attr("width",(t=>this._bottomScale(t[o]))).attr("y",(t=>this._leftScale(t[a]))).attr("fill",n).selection().on("click",((t,e)=>s(t,e,this._data))),E.call(this,"_rectElements",r)}}class O{constructor(t,e,i){this._domId=t,this._option=e,this._theme=i||A,G.call(this,t,e)}render(){r.call(this),d.call(this),$.call(this),p.call(this,"_rectGroup","rect-group","main"),this.renderRect()}renderRect(){const{verticalBar:{uniqueKey:t,animation:{duration:e,ease:i},on:{click:s}},axisBottom:{key:o},axisLeft:{key:a},tooltip:{format:r}}=this._option,{primary1:n}=this._theme;this._rectElements=this._rectGroup.selectAll("rect").data(this._data,t?e=>e[t]:t).join((t=>t.append("rect").attr("width",this._bandwidth()).attr("y",this._innerHeight).attr("x",(t=>this._bottomScale(t[o])))),(t=>t),(t=>t.remove())).transition().duration(e).ease(i).attr("height",(t=>this._innerHeight-this._leftScale(t[a]))).attr("y",(t=>this._leftScale(t[a]))).attr("x",(t=>this._bottomScale(t[o]))).attr("fill",n).selection().on("click",((t,e)=>s(t,e,this._data))),E.call(this,"_rectElements",r)}}s.registerStrategy("horizontalBar",W).registerStrategy("verticalBar",O),t.AlgorithmBar=H,t.HorizontalBar=W,t.VerticalBar=O,t.init=(t,e,i)=>s.useStrategy(t,e,i),t.register=(t,e)=>{s.registerStrategy(t,e)},Object.defineProperty(t,"__esModule",{value:!0})}));
